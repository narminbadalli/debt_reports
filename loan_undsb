SELECT DISTINCT
     round (DMFASRPT.LO_SUMS.AMT_UNDSB/DMFASRPT.LOAN_TRANCHES.LOAN_AMOUNT*100, 2) AS PCENT_UNDSB,
     DMFASRPT.LOAN_TRANCHES.DEBT_CATEGORY,
     DMFASRPT.LOAN_TRANCHES.DEBT_SOURCE,
     DMFASRPT.LOAN_TRANCHES.CREDITOR_NAME,
     DMFASRPT.LOAN_TRANCHES.STATUS,
     DMFASRPT.LO_SUMS.LO_NO,
     DMFASRPT.LOAN_TRANCHES.LOAN_AMOUNT,
     DMFASRPT.LO_SUMS.AMT_UNDSB,
     DMFASRPT.LOAN_TRANCHES.DATE_DRAWING_LIMIT,
     DMFASRPT.LOAN_TRANCHES.DATE_EFFECTIVE
FROM
     DMFASRPT.LO_SUMS INNER JOIN DMFASRPT.LOAN_TRANCHES ON DMFASRPT.LO_SUMS.LO_NO = DMFASRPT.LOAN_TRANCHES.LOAN_ID
WHERE
     (DMFASRPT.LO_SUMS.AMT_UNDSB > 0
 AND DMFASRPT.LOAN_TRANCHES.DATE_DRAWING_LIMIT > SYSDATE)
 AND (DMFASRPT.LO_SUMS.LO_NO = DMFASRPT.LOAN_TRANCHES.LOAN_ID)
 AND DMFASRPT.LOAN_TRANCHES.STATUS = 'ACTIVE'
 AND DMFASRPT.LOAN_TRANCHES.DEBT_SOURCE = 'EXTERNAL'
ORDER BY
     DMFASRPT.LOAN_TRANCHES.DEBT_CATEGORY ASC,
     DMFASRPT.LOAN_TRANCHES.DEBT_SOURCE ASC,
     DMFASRPT.LOAN_TRANCHES.CREDITOR_NAME ASC,
     DMFASRPT.LOAN_TRANCHES.STATUS ASC,
     DMFASRPT.LO_SUMS.LO_NO ASC
