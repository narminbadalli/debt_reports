SELECT
     DMFASRPT.DEBT_SERV_OPERS.DSO_ID,
     LOAN_TRANCHES.TRANCHE_NO,
     LOAN_TRANCHES.DEBT_CATEGORY,
     LOAN_TRANCHES.DEBT_SOURCE,
     LOAN_TRANCHES.CREDITOR_NAME,
     LOAN_TRANCHES.PUBLIC_GUARANTEE,
     LOAN_TRANCHES.STATUS,
     LOAN_TRANCHES.LOAN_ID,
     LOAN_TRANCHES.TRANCHE_CURRENCY,
     LOAN_TRANCHES.DEBTOR_NAME,
     DMFASRPT.DEBT_SERV_OPERS.D_CRED_VAL,
     DMFASRPT.DEBT_SERV_OPERS.D_SCH,
     DMFASRPT.DEBT_SERV_OPERS.CU_EFF,
     DMFASRPT.DEBT_SERV_OPERS.AMT_CU_EFF,
     DMFASRPT.DEBT_SERV_OPERS.AMT_CU_LOCAL,
     DMFASRPT.DEBT_SERV_OPERS.AMT_CU_BASE,
     DMFASRPT.DEBT_SERV_OPERS.AMT_SCH,
     DMFASRPT.DEBT_SERV_OPERS.D_LOCAL_EXCH_RTE,
     DMFASRPT.CD_NMS.NAME,
     CD_NMS_A.NAME AS NAME_A,
     DMFASRPT.DEBT_SERV_OPERS.AMT_CU_USD
FROM
     DMFASRPT.DEBT_SERV_OPERS INNER JOIN LOAN_TRANCHES LOAN_TRANCHES ON DMFASRPT.DEBT_SERV_OPERS.LO_NO = LOAN_TRANCHES.LOAN_ID
     AND DMFASRPT.DEBT_SERV_OPERS.TRA_NO = LOAN_TRANCHES.TRANCHE_NO
     INNER JOIN DMFASRPT.CD_NMS ON DMFASRPT.DEBT_SERV_OPERS.CG_TRNS_TYP = DMFASRPT.CD_NMS.CG_NO
     AND DMFASRPT.CD_NMS.CD_CODE = DMFASRPT.DEBT_SERV_OPERS.CD_TRNS_TYP
     INNER JOIN DMFASRPT.CD_NMS CD_NMS_A ON DMFASRPT.DEBT_SERV_OPERS.CG_MEDIUM = CD_NMS_A.CG_NO
     AND CD_NMS_A.CD_CODE = DMFASRPT.DEBT_SERV_OPERS.CD_MEDIUM
WHERE
     LOAN_TRANCHES.DURATION IN ('MEDIUM/LONG-TERM','SHORT-TERM')
 AND DMFASRPT.CD_NMS.LA_ID = '1'
 AND CD_NMS_A.LA_ID = '1'
 AND DMFASRPT.DEBT_SERV_OPERS.D_CRED_VAL > DMFASRPT.DEBT_SERV_OPERS.D_SCH+30
  AND DMFASRPT.DEBT_SERV_OPERS.D_SCH > '01-JAN-2024'
 AND LOAN_TRANCHES.STATUS = 'ACTIVE'
 ORDER BY
DMFASRPT.DEBT_SERV_OPERS.D_ENTRY ASC
